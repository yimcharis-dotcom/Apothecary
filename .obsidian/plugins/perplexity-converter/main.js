/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var p=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var M=Object.prototype.hasOwnProperty;var O=(i,r)=>{for(var e in r)p(i,e,{get:r[e],enumerable:!0})},E=(i,r,e,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of y(r))!M.call(i,n)&&n!==e&&p(i,n,{get:()=>r[n],enumerable:!(t=b(r,n))||t.enumerable});return i};var A=i=>E(p({},"__esModule",{value:!0}),i);var w={};O(w,{default:()=>h});module.exports=A(w);var u=require("obsidian"),C={sourceHeaders:["Quellen","Sources","Citations:"],autoSelectOnMobile:!0};function v(){if(typeof navigator>"u")return!1;let i=navigator.userAgent.toLowerCase();return i.includes("iphone")||i.includes("ipad")||i.includes("ipod")}var h=class extends u.Plugin{async onload(){await this.loadSettings(),this.addCommand({id:"process-selected-text",name:"Process selected text",editorCallback:e=>{let t=e.getSelection();if(!t&&v()&&this.settings.autoSelectOnMobile){let a=e.getValue();a&&(e.setSelection({line:0,ch:0},{line:e.lineCount()-1,ch:e.getLine(e.lineCount()-1).length}),t=a)}let n=this.process_text(t);e.replaceSelection(n)}}),this.addSettingTab(new f(this.app,this))}onunload(){}process_text(e){if(!e)return"";let t=e.split(`
`);if(!t.some(s=>this.settings.sourceHeaders.includes(s.trim())))return e;let n={},a=!1;for(let s of t){if(this.settings.sourceHeaders.includes(s)){a=!0;continue}if(a&&s){let l=s.match(/\[(\d+)\]/);if(l){let o=l[1],c=s.match(/(https?:\/\/\S+)/);if(c){let d=c[1].trim();n[o]=d}}}}let g=[];a=!1;for(let s of t){if(this.settings.sourceHeaders.includes(s)){a=!0,g.push(s);continue}if(a&&s){let l=s.match(/\[(\d+)\]/);if(l){let o=l[1],c=s.match(/(https?:\/\/\S+)/);if(c){let d=c[1].trim(),S=s.indexOf("]")+1,m=s.indexOf("http");if(S>0&&m>0){let x=s.slice(S,m).trim();x?g.push(`\\[${o}\\] [${x}](${d})`):g.push(`\\[${o}\\] ${d}`);continue}}}g.push(s)}else{let l=s;for(let[o,c]of Object.entries(n))l=l.replaceAll(`[${o}]`,`[\`[${o}]\`](${c})`);g.push(l)}}return g.join(`
`)}async loadSettings(){this.settings=Object.assign({},C,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}},f=class extends u.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}display(){let{containerEl:e}=this;e.empty(),new u.Setting(e).setName("References start line tags").setDesc("Strings (complete lines) that indicate the start of the references section").addTextArea(t=>t.setPlaceholder("Enter your start line tags").setValue(this.plugin.settings.sourceHeaders.join(`
`)).then(n=>{n.inputEl.addClass("reference-start-line-tags-textarea")}).onChange(async n=>{this.plugin.settings.sourceHeaders=n.trimEnd().split(`
`).filter(a=>a.trim()),await this.plugin.saveSettings()})),new u.Setting(e).setName("Auto-select all text on mobile").setDesc("When enabled, automatically selects all text in the note on iOS/iPadOS if no text is currently selected").addToggle(t=>t.setValue(this.plugin.settings.autoSelectOnMobile).onChange(async n=>{this.plugin.settings.autoSelectOnMobile=n,await this.plugin.saveSettings()}))}};

/* nosourcemap */